generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  username  String   @unique
  email     String   @unique
  createdAt DateTime @default(now()) @map("created_at")
  
  comments Comment[]
  
  @@map("users")
}

model Plot {
  id                Int       @id @default(autoincrement())
  objectid          Int?      @unique
  longitude         Float?    // Longitude (WGS84)
  latitude          Float?    // Latitude (WGS84)
  address           String?
  owner1            String?
  owner2            String?
  bldgDesc          String?   @map("bldg_desc")
  opaId             String?   @map("opa_id")
  lniAddressKey     String?   @map("lniaddresskey")
  councilDistrict   String?   @map("councildistrict")
  zoningBaseDistrict String?  @map("zoningbasedistrict")
  zipcode           String?
  landRank          Float?    @map("land_rank")
  buildRank         Float?    @map("build_rank")
  vacantFlag        String?   @map("vacant_flag")
  vacantRank        Float?    @map("vacant_rank")
  dateUpdate        DateTime? @map("date_update")
  createdAt         DateTime  @default(now()) @map("created_at")
  
  comments  Comment[]
  neighbors Neighbors?
  
  @@map("plots")
}

model Neighbors {
  id         Int   @id // This matches the plot id
  neighborIds Int[] // Array of plot ids for the top 10 nearest neighbors
  
  plot Plot @relation(fields: [id], references: [id], onDelete: Cascade)
  
  @@map("neighbors")
}

model Comment {
  id        Int      @id @default(autoincrement())
  plotId    Int      @map("plot_id")  // Database column name
  userId    Int      @map("user_id")  // Database column name
  content   String
  createdAt DateTime @default(now()) @map("created_at")
  upvote    Int      @default(0)
  downvote  Int      @default(0)
  
  plot Plot @relation(fields: [plotId], references: [id])  // Links to Plot.id
  user User @relation(fields: [userId], references: [id])  // Links to User.id
  
  @@map("comments")
}

